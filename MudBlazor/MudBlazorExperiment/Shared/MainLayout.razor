@inherits LayoutComponentBase

<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Large">
            <MudPaper Elevation="5">

                <MudAppBar Color="Color.Primary" Fixed="false">
                    <MudSpacer />
                    <MudIcon Icon="@Icons.Material.Filled.ChevronLeft" Title="Prev. Week" />
                    <MudSpacer />
                    <MudText Typo="Typo.h6">Week # 26</MudText>
                    <MudSpacer />
                    <MudIcon Icon="@Icons.Material.Filled.ChevronRight" Title="Prev. Week" />
                    <MudSpacer />
                    <MudDivider />
                </MudAppBar>
                <MudTabs Elevation="4" Rounded="true" AlwaysShowScrollButtons="true" Color="@Color.Info" Class="mt-4">
                    <MudTabPanel Text="Monday" />
                    <MudTabPanel Text="Tuesday" />
                    <MudTabPanel Text="Wedneysday" />
                    <MudTabPanel Text="Thursday" />
                    <MudTabPanel Text="Friday" />
                    <MudTabPanel Text="Saturday" />
                    <MudTabPanel Text="Sunday" />
                </MudTabs>

            </MudPaper>
            <br/>
            <br />

            <MudPaper Elevation="5">
                <MudList>
                    <MudListSubheader>
                        <MudTextField @bind-Value="@searchTerm" AdornmentIcon="@Icons.Material.Filled.Brush"
                                    Adornment="Adornment.End" Immediate="true" Variant="Variant.Outlined" />
                    </MudListSubheader>

                    @foreach (var sentence in sentences)
                    {
                        <MudListItem @key="sentence" Icon="@Icons.Material.Filled.Folder">
                            <MudHighlighter
                                Class="mud-primary-text"
                                Style="background-color:transparent;font-weight:bold"
                                Text="@sentence"
                                HighlightedText="@searchTerm" />
                        </MudListItem>
                    }
                </MudList>
            </MudPaper>

            <MudForm>

                <br />

                
                <MudSelect T="string" Label="Tasks" MultiSelection="true">
                    <MudSelectItem T="string">Slæbe gips</MudSelectItem>
                    <MudSelectItem T="string">Skære gips</MudSelectItem>
                    <MudSelectItem T="string">Sætte gips op</MudSelectItem>
                </MudSelect>

                <br />

                @* STARTING TIME *@
                <MudItem>
                    <MudTimePicker
                        Adornment="Adornment.Start"
                        Label="Starting Time"
                        PickerVariant="PickerVariant.Dialog"
                        TimeEditMode="TimeEditMode.OnlyHours"
                        @bind-Time="startingTime">
                        <PickerActions>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.startTime, 0)">:00</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.startTime, 15)">:15</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.startTime, 30)">:30</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.startTime, 45)">:45</MudButton>
                            <MudButton Color="Color.Primary" OnClick="@(() => context.Close())">Ok</MudButton>
                        </PickerActions>
                    </MudTimePicker>

                    <MudText>@startingTime</MudText>
                </MudItem>
                @* /STARTING TIME *@

                @* ENDING TIME *@
                <MudItem>
                    <MudTimePicker
                        Adornment="Adornment.Start"
                        Label="Ending Time"
                        PickerVariant="PickerVariant.Dialog"
                        TimeEditMode="TimeEditMode.OnlyHours"
                        @bind-Time="endingTime">
                        <PickerActions>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.endingTime, 0)">:00</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.endingTime, 15)">:15</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.endingTime, 30)">:30</MudButton>
                            <MudButton Class="mud-theme-primary" @onclick="() => setPredefinedMinutes(Times.endingTime, 45)">:45</MudButton>
                            <MudButton Color="Color.Primary" OnClick="@(() => context.Close())">Ok</MudButton>
                        </PickerActions>
                    </MudTimePicker>

                    <MudText>@endingTime</MudText>

                </MudItem>
                @* /ENDING TIME *@

                <MudSpacer />
                
                <br />
                <MudDivider />
                <br />

                <MudText Typo="Typo.h6">List of tasks</MudText>

                <MudTextField @bind-Value="Search" Label="Search" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Search" AdornmentColor="Color.Secondary" />

                <br />

                <MudTextField T="string" Label="Comments" Variant="Variant.Outlined" Text="200.- for diesel" Lines="5"></MudTextField>

                <br />
                
                <MudButton Variant="Variant.Filled" Color="Color.Primary">Send</MudButton>
            </MudForm>
        </MudContainer>
    </MudMainContent>

</MudLayout>

@code {
    string searchTerm = "it";
    IEnumerable<string> sentences = new List<string>
    {
        "This is the first item", "This is the second item", "This is the third item"
    };

    public enum Times
    {
        startTime,
        endingTime
    }

    TimeSpan? startingTime = new TimeSpan(02, 35, 00);
    TimeSpan? endingTime = new TimeSpan(02, 35, 00);

    public string Search { get; set; }

    public void setPredefinedMinutes(Times whichTime, int minutes)
    {
        if (whichTime == Times.endingTime)
        {
            endingTime = TimeSpan.Parse(endingTime!.Value.Hours + ":" + minutes + ":00");
        }
        else
        {
            startingTime = TimeSpan.Parse(startingTime!.Value.Hours + ":" + minutes + ":00");
        }
        Console.WriteLine(endingTime);
    }
}